# 19110136, Trần Văn Thiên
# Task 4.1: Encrypt and Decrypt Text file
## Create a text file named plain.txt with content: "My name is Thien"
- First we use the following command: "*echo "My name is Thien" > plain.txt*"
<br>
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.1.png?raw=true" alt="4.1.1" width="726"><br>

- Check the content in the txt file <br>
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.2.png?raw=true" alt="4.1.2" width="726"><br>

### AES-128
- AES-128-ECB

    Encrypt

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.3.png?raw=true" alt="4.1.3" width="726"><br>

    View the encrypted file with xxd
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.4.png?raw=true" alt="4.1.4" width="726"><br>

    Decrypt

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.5.png?raw=true" alt="4.1.5" width="726"><br>

    View the decrypted file with xxd
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.6.png?raw=true" alt="4.1.6" width="726"><br>

- AES-128-CBC

    Encrypt

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.7.png?raw=true" alt="4.1.7" width="726"><br>

    View the encrypted file with xxd
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.8.png?raw=true" alt="4.1.8" width="726"><br>

    Decrypt

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.9.png?raw=true" alt="4.1.9" width="726"><br>

    View the decrypted file with xxd
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.10.png?raw=true" alt="4.1.10" width="726"><br>

- AES-128-CFB

    Encrypt

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.11.png?raw=true" alt="4.1.11" width="726"><br>

    View the encrypted file with xxd
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.12.png?raw=true" alt="4.1.12" width="726"><br>

    Decrypt

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.13.png?raw=true" alt="4.1.13" width="726"><br>

    View the decrypted file with xxd
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.14.png?raw=true" alt="4.1.14" width="726"><br>

- AES-128-OFB

    Encrypt

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.15.png?raw=true" alt="4.1.15" width="726"><br>

    View the encrypted file with xxd
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.16.png?raw=true" alt="4.1.16" width="726"><br>

    Decrypt

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.17.png?raw=true" alt="4.1.17" width="726"><br>

    View the decrypted file with xxd
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.18.png?raw=true" alt="4.1.18" width="726"><br>

- AES-128-CTR

    Encrypt

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.19.png?raw=true" alt="4.1.19" width="726"><br>

    View the encrypted file with xxd
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.20.png?raw=true" alt="4.1.20" width="726"><br>

    Decrypt

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.21.png?raw=true" alt="4.1.21" width="726"><br>

    View the decrypted file with xxd
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.22.png?raw=true" alt="4.1.22" width="726"><br>

### AES-192

- AES-192-ECB

    Encrypt

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.23.png?raw=true" alt="4.1.23" width="726"><br>

    View the encrypted file with xxd
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.24.png?raw=true" alt="4.1.24" width="726"><br>

    Decrypt

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.25.png?raw=true" alt="4.1.25" width="726"><br>

    View the decrypted file with xxd
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.26.png?raw=true" alt="4.1.26" width="726"><br>

- AES-192-CBC

    Encrypt

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.27.png?raw=true" alt="4.1.27" width="726"><br>

    View the encrypted file with xxd
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.28.png?raw=true" alt="4.1.28" width="726"><br>

    Decrypt

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.29.png?raw=true" alt="4.1.29" width="726"><br>

    View the decrypted file with xxd
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.30.png?raw=true" alt="4.1.30" width="726"><br>

- AES-192-CFB

    Encrypt

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.31.png?raw=true" alt="4.1.31" width="726"><br>

    View the encrypted file with xxd
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.32.png?raw=true" alt="4.1.32" width="726"><br>

    Decrypt

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.33.png?raw=true" alt="4.1.33" width="726"><br>

    View the decrypted file with xxd
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.34.png?raw=true" alt="4.1.34" width="726"><br>

- AES-192-OFB

    Encrypt

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.35.png?raw=true" alt="4.1.35" width="726"><br>

    View the encrypted file with xxd
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.36.png?raw=true" alt="4.1.36" width="726"><br>

    Decrypt

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.37.png?raw=true" alt="4.1.37" width="726"><br>

    View the decrypted file with xxd
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.38.png?raw=true" alt="4.1.38" width="726"><br>

- AES-192-CTR

    Encrypt

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.39.png?raw=true" alt="4.1.39" width="726"><br>

    View the encrypted file with xxd
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.40.png?raw=true" alt="4.1.40" width="726"><br>

    Decrypt

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.41.png?raw=true" alt="4.1.41" width="726"><br>

    View the decrypted file with xxd
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.42.png?raw=true" alt="4.1.42" width="726"><br>

### AES-256
- AES-256-ECB

    Encrypt

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.43.png?raw=true" alt="4.1.43" width="726"><br>

    View the encrypted file with xxd
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.44.png?raw=true" alt="4.1.44" width="726"><br>

    Decrypt

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.45.png?raw=true" alt="4.1.45" width="726"><br>

    View the decrypted file with xxd
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.46.png?raw=true" alt="4.1.46" width="726"><br>

- AES-256-CBC

    Encrypt

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.47.png?raw=true" alt="4.1.47" width="726"><br>

    View the encrypted file with xxd
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.48.png?raw=true" alt="4.1.48" width="726"><br>

    Decrypt

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.49.png?raw=true" alt="4.1.49" width="726"><br>

    View the decrypted file with xxd
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.50.png?raw=true" alt="4.1.50" width="726"><br>

- AES-256-CFB

    Encrypt

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.51.png?raw=true" alt="4.1.51" width="726"><br>

    View the encrypted file with xxd
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.52.png?raw=true" alt="4.1.52" width="726"><br>

    Decrypt

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.53.png?raw=true" alt="4.1.53" width="726"><br>

    View the decrypted file with xxd
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.54.png?raw=true" alt="4.1.54" width="726"><br>

- AES-256-OFB

    Encrypt

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.55.png?raw=true" alt="4.1.55" width="726"><br>

    View the encrypted file with xxd
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.56.png?raw=true" alt="4.1.56" width="726"><br>

    Decrypt

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.57.png?raw=true" alt="4.1.57" width="726"><br>

    View the decrypted file with xxd
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.58.png?raw=true" alt="4.1.58" width="726"><br>

- AES-256-CTR

    Encrypt

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.59.png?raw=true" alt="4.1.59" width="726"><br>

    View the encrypted file with xxd
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.60.png?raw=true" alt="4.1.60" width="726"><br>

    Decrypt

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.61.png?raw=true" alt="4.1.61" width="726"><br>

    View the decrypted file with xxd
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.1.62.png?raw=true" alt="4.1.62" width="726"><br>


# Task 4.2 Encryption Mode – ECB vs. CBC
## Step 1: Separate the header and body of the image file with 2 commands: 
- *"dd if=origin.bmp of=header.bin bs=1* count=54"
- *"dd if=origin.bmp of=body.bin bs=1 skip=54"*
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.2.1.png?raw=true" alt="4.2.1" width="726"><br>

## Step 2: Encrypt the body of the image file using ECB with command and KEY="00112233445566778899AABBCCDDEEFF00112233445566778899AABBCCDDEEFF"
- *openssl enc -aes-256-ecb -nosalt -in body.bin -out ecb_encrypted_body.bin -K 00112233445566778899AABBCCDDEEFF00112233445566778899AABBCCDDEEFF*
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.2.2.png?raw=true" alt="4.2.2" width="726"><br>

## Step 3: Pair the encrypted header and body (ECB) with the command:
- *cat header.bin ecb_encrypted_body.bin > ecb_encrypted.bmp*
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.2.3.png?raw=true" alt="4.2.3" width="726"><br>

## Step 4: Encode the body of the image file using CBC with command and KEY="00112233445566778899AABBCCDDEEFF00112233445566778899AABBCCDDEEFF" IV="0102030405060708090A0B0C0D0E0F10"
- *openssl enc -aes-256-cbc -nosalt -in body.bin -out cbc_encrypted_body.bin -K 00112233445566778899AABBCCDDEEFF00112233445566778899AABBCCDDEEFF -iv 0102030405060708090A0B0C0D0E0F10*
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.2.4.png?raw=true" alt="4.2.4" width="726"><br>

## Step 5: Encrypted header and body concatenation (CBC) with command:
- *cat header.bin cbc_encrypted_body.bin > cbc_encrypted.bmp*
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.2.5.png?raw=true" alt="4.2.5" width="726"><br>

## Step 6: View and compare encrypted images
- *origin.bmp*<br>
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.2.6.png?raw=true" alt="4.2.6" width="726"><br>

- *origin.bmp*<br>
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.2.7.png?raw=true" alt="4.2.7" width="726"><br>

- *origin.bmp*<br>
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.2.8.png?raw=true" alt="4.2.8" width="726"><br>

## Step 7: Observe and explain
- ECB Mode: You will see that images encoded with ECB can still recognize some details of the original image. That's because ECB mode encrypts each block independently, resulting in identical blocks of the original image retaining their original form in the encrypted image. This makes ECB insecure for image encryption.
- CBC Mode: Images encoded with CBC will look like random noise and details of the original image cannot be recognized. CBC uses the results of each previous block to encrypt the next block, so each encryption block is unique even if the original data blocks are the same. This makes CBC more secure than ECB for image encryption.
# Task 4.3: Encryption Mode – Corrupted Cipher Text
## 1. Create a text file that is at least 64 bytes long and check the content of file with command:
- *echo "Tôi tên là Trần Văn Thiên có mã số sinh viên là 19110136." > plain.txt*
- *cat plain.txt*

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.2.8.png?raw=true" alt="4.3.1" width="726"><br>

## 2. Encrypt files using AES-256
- Prepare key and initialization vector (IV) with command: *KEY="00112233445566778899AABBCCDDEEFF00112233445566778899AABBCCDDEEFF"
IV="0102030405060708090A0B0C0D0E0F10"*
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.2.8.png?raw=true" alt="4.3.2" width="726"><br>

- Encryption with ECB with command:" 
*openssl enc -aes-256-ecb -nosalt -in plain.txt -out ecb_encrypted.bin -K $KEY* "
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.2.8.png?raw=true" alt="4.3.3" width="726"><br>

- Encryption with CBC with command:"*openssl enc -aes-256-cbc -nosalt -in plain.txt -out cbc_encrypted.bin -K $KEY -iv $IV*"
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.2.8.png?raw=true" alt="4.3.4" width="726"><br>

- Encryption with CFB with command:"*openssl enc -aes-256-cfb -nosalt -in plain.txt -out cfb_encrypted.bin -K $KEY -iv $IV*"
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.2.8.png?raw=true" alt="4.3.5" width="726"><br>

- Encryption with OFB with command:"*openssl enc -aes-256-ofb -nosalt -in plain.txt -out ofb_encrypted.bin -K $KEY -iv $IV*"
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.2.8.png?raw=true" alt="4.3.6" width="726"><br>

## 3. Corrupt one bit of the 5th byte in the encrypted file

- Corrupted the 5th byte in the ECB file with command:

    *dd if=ecb_encrypted.bin of=ecb_corrupted.bin bs=1 count=4*

    *dd if=ecb_encrypted.bin of=ecb_corrupted.bin bs=1 skip=5 seek=5 conv=notrunc*

    *printf "\xFF" | dd of=ecb_corrupted.bin bs=1 seek=4 count=1 conv=notrunc*

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.2.8.png?raw=true" alt="4.3.7" width="726"><br>

- Corrupted the 5th byte in the CBC file with command:

    *dd if=cbc_encrypted.bin of=cbc_corrupted.bin bs=1 count=4*

    *dd if=cbc_encrypted.bin of=cbc_corrupted.bin bs=1 skip=5 seek=5 conv=notrunc*

    *printf "\xFF" | dd of=cbc_corrupted.bin bs=1 seek=4 count=1 conv=notrunc*

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.2.8.png?raw=true" alt="4.3.8" width="726"><br>

- Corrupted the 5th byte in the CFB file with command:

    *dd if=cfb_encrypted.bin of=cbc_corrupted.bin bs=1 count=4*

    *dd if=cfb_encrypted.bin of=cbc_corrupted.bin bs=1 skip=5 seek=5 conv=notrunc*

    *printf "\xFF" | dd of=cfb_corrupted.bin bs=1 seek=4 count=1 conv=notrunc*

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.2.8.png?raw=true" alt="4.3.9" width="726"><br>

- Corrupted the 5th byte in the OFB file with command:

    *dd if=ofb_encrypted.bin of=cbc_corrupted.bin bs=1 count=4*

    *dd if=ofb_encrypted.bin of=cbc_corrupted.bin bs=1 skip=5 seek=5 conv=notrunc*

    *printf "\xFF" | dd of=ofb_corrupted.bin bs=1 seek=4 count=1 conv=notrunc*

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.2.8.png?raw=true" alt="4.3.10" width="726"><br>

## 4. Decrypt the corrupted file using the correct key and IV
- Decrypt corrupted files in ECB with command: "*openssl enc -d -aes-256-ecb -nosalt -in ecb_corrupted.bin -out ecb_decrypted.txt -K $KEY*"

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.2.8.png?raw=true" alt="4.3.11" width="726"><br>

- Decrypt corrupted files in CBC with command: "*openssl enc -d -aes-256-cbc -nosalt -in cbc_corrupted.bin -out cbc_decrypted.txt -K $KEY -iv $IV*"

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.2.8.png?raw=true" alt="4.3.12" width="726"><br>

- Decrypt corrupted files in CFB with command: "*openssl enc -d -aes-256-cfb -nosalt -in cfb_corrupted.bin -out cfb_decrypted.txt -K $KEY -iv $IV*"

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.2.8.png?raw=true" alt="4.3.13" width="726"><br>

- Decrypt corrupted files in OFB with command: "*openssl enc -d -aes-256-ofb -nosalt -in ofb_corrupted.bin -out ofb_decrypted.txt -K $KEY -iv $IV*"

<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.2.8.png?raw=true" alt="4.3.14" width="726"><br>

### 4.a. Observe and explain
#### Prediction before implementation:

- ECB: A failed block will only affect that block. You will lose data in that block but other blocks will not be affected.
- CBC: One bit error in one block corrupts that entire block and one bit in the next block.
- CFB: One bit error will corrupt the entire current block and can propagate through subsequent blocks until the IV is reset.
- OFB: A bit error will only affect one corresponding bit in the plaintext.
Observe after implementation.
#### Observe
<img src="https://github.com/TranVanThien111/Encrypting-Large-Message/blob/main/images/4.2.8.png?raw=true" alt="4.3.15" width="726"><br>

#### Observe after implementation:

- ECB: When decoding, you will find that part of the text is corrupted, but other parts are intact.
- CBC: The text is corrupted at byte position 5 and the bytes in the next block are also corrupted.
- CFB: Errors will propagate through bytes, leading to more severe loss of information.
- OFB: Only one corresponding bit in the plaintext is affected, the rest of the text remains intact.
### 4.b Explain
- ECB: Vulnerable to pattern analysis attacks because each block is encrypted independently.
- CBC: Improved security compared to ECB, but an error in the data can propagate to the next block.
- CFB: Better for continuous data transmission, but errors in data can propagate.
- OFB: Best protection at keeping errors from propagating, but does not provide data integrity.
### 4.c What is the implication of these differences?
- What is special here is that these encryption modes show that different applications require different encryption modes depending on the security and integrity requirements of the data.





