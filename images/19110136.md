# 19110136, Trần Văn Thiên
# Task 4.1: Encrypt and Decrypt Text file
## Create a text file named plain.txt with content: "My name is Thien"
<span style="color:blue">First we use the following command: "echo "My name is Thien" > plain.txt"
</span><br>
<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.1" width="726"><br>
<span style="color:blue">Check the content in the txt file </span>
<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.2" width="726"><br>

### AES-128
- AES-128-ECB

    Encrypt

<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.3" width="726"><br>

    View the encrypted file with xxd
<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.4" width="726"><br>

    Decrypt

<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.5" width="726"><br>

    View the decrypted file with xxd
<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.6" width="726"><br>

- AES-128-CBC

    Encrypt

<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.7" width="726"><br>

    View the encrypted file with xxd
<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.8" width="726"><br>

    Decrypt

<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.9" width="726"><br>

    View the decrypted file with xxd
<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.10" width="726"><br>

- AES-128-CFB

    Encrypt

<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.11" width="726"><br>

    View the encrypted file with xxd
<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.12" width="726"><br>

    Decrypt

<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.13" width="726"><br>

    View the decrypted file with xxd
<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.14" width="726"><br>

- AES-128-OFB

    Encrypt

<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.15" width="726"><br>

    View the encrypted file with xxd
<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.16" width="726"><br>

    Decrypt

<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.17" width="726"><br>

    View the decrypted file with xxd
<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.18" width="726"><br>

- AES-128-CTR

    Encrypt

<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.19" width="726"><br>

    View the encrypted file with xxd
<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.20" width="726"><br>

    Decrypt

<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.21" width="726"><br>

    View the decrypted file with xxd
<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.22" width="726"><br>

### AES-192

- AES-192-ECB

    Encrypt

<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.23" width="726"><br>

    View the encrypted file with xxd
<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.24" width="726"><br>

    Decrypt

<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.25" width="726"><br>

    View the decrypted file with xxd
<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.26" width="726"><br>

- AES-192-CBC

    Encrypt

<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.27" width="726"><br>

    View the encrypted file with xxd
<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.28" width="726"><br>

    Decrypt

<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.29" width="726"><br>

    View the decrypted file with xxd
<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.30" width="726"><br>

- AES-192-CFB

    Encrypt

<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.31" width="726"><br>

    View the encrypted file with xxd
<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.32" width="726"><br>

    Decrypt

<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.33" width="726"><br>

    View the decrypted file with xxd
<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.34" width="726"><br>

- AES-192-OFB

    Encrypt

<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.35" width="726"><br>

    View the encrypted file with xxd
<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.36" width="726"><br>

    Decrypt

<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.37" width="726"><br>

    View the decrypted file with xxd
<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.38" width="726"><br>

- AES-192-CTR

    Encrypt

<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.39" width="726"><br>

    View the encrypted file with xxd
<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.40" width="726"><br>

    Decrypt

<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.41" width="726"><br>

    View the decrypted file with xxd
<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.42" width="726"><br>

### AES-256
- AES-256-ECB

    Encrypt

<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.43" width="726"><br>

    View the encrypted file with xxd
<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.44" width="726"><br>

    Decrypt

<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.45" width="726"><br>

    View the decrypted file with xxd
<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.46" width="726"><br>

- AES-256-CBC

    Encrypt

<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.47" width="726"><br>

    View the encrypted file with xxd
<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.48" width="726"><br>

    Decrypt

<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.49" width="726"><br>

    View the decrypted file with xxd
<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.50" width="726"><br>

- AES-256-CFB

    Encrypt

<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.51" width="726"><br>

    View the encrypted file with xxd
<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.52" width="726"><br>

    Decrypt

<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.53" width="726"><br>

    View the decrypted file with xxd
<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.54" width="726"><br>

- AES-256-OFB

    Encrypt

<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.55" width="726"><br>

    View the encrypted file with xxd
<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.56" width="726"><br>

    Decrypt

<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.57" width="726"><br>

    View the decrypted file with xxd
<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.58" width="726"><br>

- AES-256-CTR

    Encrypt

<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.59" width="726"><br>

    View the encrypted file with xxd
<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.60" width="726"><br>

    Decrypt

<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.61" width="726"><br>

    View the decrypted file with xxd
<img src="https://github.com/TranVanThien111/Firewall-Lab/blob/main/images/1.png?raw=true" alt="4.1.62" width="726"><br>

<img width="500" alt="Screenshot" src="https://github.com/Will-Zidane/SecurityLab/blob/main/Firewall/Screenshot%202024-07-15%20at%2019.08.25.png?raw=true"><br>
<span style="color:blue">First we will try ping:</span><br>
## Outsider ping to Inner1:
<span style="color:blue">Ping success : </span>
<img width="500" alt="Screenshot" src="https://github.com/Will-Zidane/SecurityLab/blob/main/Firewall/Screenshot%202024-07-15%20at%2019.29.43.png?raw=true"><br>
## Inner1 ping to Outsider:
<span style="color:blue">Ping success : </span>
<img width="500" alt="Screenshot" src="https://github.com/Will-Zidane/SecurityLab/blob/main/Firewall/Screenshot%202024-07-15%20at%2019.29.35.png?raw=true"><br>
## Router telnet Inner1:
<span style="color:blue">We can login to exam account : </span>
<img width="500" alt="Screenshot" src="https://github.com/Will-Zidane/SecurityLab/blob/main/Firewall/Screenshot%202024-07-15%20at%2019.34.38.png?raw=true"><br>
## Use Curl in outsider and inner1 success:
<img width="500" alt="Screenshot" src="https://github.com/Will-Zidane/SecurityLab/blob/main/Firewall/Screenshot%202024-07-15%20at%2019.38.54.png?raw=true"><br>
<img width="500" alt="Screenshot" src="https://github.com/Will-Zidane/SecurityLab/blob/main/Firewall/Screenshot%202024-07-15%20at%2019.39.00.png?raw=true"><br>
<span style="color:blue">Now we use </span>`` iptables --line-numbers -L `` <span style="color:blue"> to display the firewall rules in router: </span><br>

<img width="500" alt="Screenshot" src="https://github.com/Will-Zidane/SecurityLab/blob/main/Firewall/Screenshot%202024-07-15%20at%2019.14.42.png?raw=true"><br>
<span style="color:blue">Setup rules on router to block all access we use:</span> <br>
        `` iptables -P INPUT DROP``<span style="color:blue"> This command sets the default policy for the INPUT chain to DROP</span>
        <br>
        `` iptables -P FORWARD DROP``<span style="color:blue"> This command sets the default policy for the FORWARD chain to DROP</span>
        <br>
        `` iptables -P OUTPUT ACCEPT ``<span style="color:blue"> This command sets the default policy for the OUTPUT chain to ACCEPT</span>
<br>
<img width="500" alt="Screenshot" src="https://github.com/Will-Zidane/SecurityLab/blob/main/Firewall/Screenshot%202024-07-15%20at%2019.26.50.png?raw=true"><br>
<span style="color:blue">The router cannot use telnet: </span><br>
<img width="500" alt="Screenshot" src="https://github.com/Will-Zidane/SecurityLab/blob/main/Firewall/Screenshot%202024-07-15%20at%2019.42.32.png?raw=true"><br>
<span style="color:blue">The outsider cannot ping to inner1:</span><br>
<img width="500" alt="Screenshot" src="https://github.com/Will-Zidane/SecurityLab/blob/main/Firewall/Screenshot%202024-07-15%20at%2019.43.42.png?raw=true"><br>
<span style="color:blue">The inner1 cannot ping to outsider: </span><br>
<img width="500" alt="Screenshot" src="https://github.com/Will-Zidane/SecurityLab/blob/main/Firewall/Screenshot%202024-07-15%20at%2019.43.46.png?raw=true"><br>
<span style="color:blue">Setup rules on router to allow ping:
</span> <br>
        `` iptables -A INPUT -p icmp --icmp-type echo-request -j ACCEPT``<span style="color:blue"> This rule is added to the INPUT chain. It specifies that any incoming ICMP packets that are of the type echo-request (these are commonly known as ping requests) should be accepted.</span>
        <br>
        `` iptables -A INPUT -p icmp --icmp-type echo-reply -j ACCEPT``<span style="color:blue"> Similar to the first rule, this one is also added to the INPUT chain. It allows incoming ICMP packets that are of the type echo-reply. This rule is useful for receiving responses to the ping requests sent from the system.</span>
        <br>
        `` iptables -A INPUT -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT``<span style="color:blue"> This rule uses the connection tracking module (conntrack) to allow all incoming packets that are in a state of RELATED or ESTABLISHED. The ESTABLISHED state refers to packets that are part of an already existing connection (like an ongoing file download or an active SSH session). The RELATED state is used for packets that are not part of the existing connection but are related to it in some way (like FTP data connections related to an already established FTP control connection).</span>
<br>
<span style="color:blue">Now the router have rules:</span><br>
<img width="500" alt="Screenshot" src="https://github.com/Will-Zidane/SecurityLab/blob/main/Firewall/Screenshot%202024-07-15%20at%2019.52.30.png?raw=true"><br>
<span style="color:blue">Outsider just can ping to router</span><br>
<img width="500" alt="Screenshot" src="https://github.com/Will-Zidane/SecurityLab/blob/main/Firewall/Screenshot%202024-07-15%20at%2019.54.31.png?raw=true"><br>
<span style="color:blue">Inner1 just can ping to router</span><br>
<img width="500" alt="Screenshot" src="https://github.com/Will-Zidane/SecurityLab/blob/main/Firewall/Screenshot%202024-07-15%20at%2019.54.23.png?raw=true"><br>

# Task 2: Setup rules on router to prevent computers on subnet 10.9.0.0/24 from accessing the internal web server 
## Set up environment

<span style="color:blue">First we refresh the iptables rules </span><br>
<img width="500" alt="Screenshot" src="https://github.com/Will-Zidane/SecurityLab/blob/main/Firewall/Screenshot%202024-07-15%20at%2020.02.29.png?raw=true"><br>
<span style="color:blue">We see the outsider can access to the iweb </span><br>
<img width="500" alt="Screenshot" src="https://github.com/Will-Zidane/SecurityLab/blob/main/Firewall/Screenshot%202024-07-15%20at%2020.03.55.png?raw=true"><br>
<span style="color:blue">And outsider can telnet the inner1 </span><br>
<img width="500" alt="Screenshot" src="https://github.com/Will-Zidane/SecurityLab/blob/main/Firewall/Screenshot%202024-07-15%20at%2020.05.38.png?raw=true"><br>

<span style="color:blue">Now we set the rules for router to block subnet 10.9.0.0/24 to access iweb :
</span> <br>
        `` iptables -A FORWARD -s 10.9.0.0/24 -d 172.16.10.110 -p tcp --dport 80 -j DROP``<span style="color:blue"> This rule adds to the FORWARD chain a directive to drop TCP packets that are routed (forwarded) through the system.
        The ``-s 10.9.0.0/24`` specifies the source network, meaning this rule applies to packets originating from any IP address in the 10.9.0.0 to 10.9.0.255 range.
        The ``-d 172.16.10.110`` specifies the destination IP address for the packets.
        The ``--dport 80`` indicates that the destination port of the packet must be 80, which is the standard port for HTTP traffic.
        The ``-j DROP`` part of the rule tells iptables to drop these packets, meaning they will not be forwarded to the destination.</span>
        <br>
        `` iptables -A FORWARD -s 10.9.0.0/24 -d 172.16.10.110 -p tcp --dport 443 -j DROP``<span style="color:blue"> Similar to the first rule, this one is also for the FORWARD chain but targets packets intended for port 443, the standard port for HTTPS (secured HTTP) traffic.
        It shares the same source network (10.9.0.0/24) and destination IP address (172.16.10.110).
        The rule specifies that any TCP packet destined for port 443 should also be dropped.</span>
        <br>
<span style="color:blue">And now we have the rules :
</span> <br>
<img width="500" alt="Screenshot" src="https://github.com/Will-Zidane/SecurityLab/blob/main/Firewall/Screenshot%202024-07-15%20at%2020.24.09.png?raw=true"><br>
<span style="color:blue">Now the outsider cannot curl or telnet iweb :
</span> <br>
<img width="500" alt="Screenshot" src="https://github.com/Will-Zidane/SecurityLab/blob/main/Firewall/Screenshot%202024-07-15%20at%2020.12.08.png?raw=true"><br>
<img width="500" alt="Screenshot" src="https://github.com/Will-Zidane/SecurityLab/blob/main/Firewall/Screenshot%202024-07-15%20at%2020.12.28.png?raw=true"><br>

# Task 3: The badsite was found to contain malwares and source of delivering bots. Setup rules on router to stop computers on subnet 172.16.10.0/24 from accessing the badsite.
## Set up environment


<span style="color:blue">First we refresh the iptables rules </span><br>
<img width="500" alt="Screenshot" src="https://github.com/Will-Zidane/SecurityLab/blob/main/Firewall/Screenshot%202024-07-15%20at%2020.02.29.png?raw=true"><br>
<span style="color:blue">We see the inner1 can access to the badsite </span><br>
<img width="500" alt="Screenshot" src="https://github.com/Will-Zidane/SecurityLab/blob/main/Firewall/Screenshot%202024-07-15%20at%2020.16.24.png?raw=true"><br>
<span style="color:blue">And inner1 can telnet the outsider1 </span><br>
<img width="500" alt="Screenshot" src="https://github.com/Will-Zidane/SecurityLab/blob/main/Firewall/Screenshot%202024-07-15%20at%2020.16.56.png?raw=true"><br>

<span style="color:blue">Now we set the rules for router to block subnet 10.9.0.0/24 to access iweb :
</span> <br>
        `` iptables -A FORWARD -s 172.16.10.0/24 -d 10.9.0.10 -p tcp --dport 80 -j DROP``<span style="color:blue"> This rule adds to the FORWARD chain a directive to drop TCP packets that are routed (forwarded) through the system.
        The ``-s 172.16.10.0 `` specifies the source network, meaning this rule applies to packets originating from any IP address in the 172.16.10.0 to 172.16.10.255 range.
        The ``-d 10.9.0.10`` specifies the destination IP address for the packets.
        The ``--dport 80`` indicates that the destination port of the packet must be 80, which is the standard port for HTTP traffic.
        The ``-j DROP`` part of the rule tells iptables to drop these packets, meaning they will not be forwarded to the destination.</span>
        <br>
        `` iptables -A FORWARD -s 172.16.10.0/24 -d 10.9.0.10 -p tcp --dport 443 -j DROP``<span style="color:blue"> Similar to the first rule, this one is also for the FORWARD chain but targets packets intended for port 443, the standard port for HTTPS (secured HTTP) traffic.
        It shares the same source network (172.16.10.0/24) and destination IP address (10.9.0.10).
        The rule specifies that any TCP packet destined for port 443 should also be dropped.</span>
        <br>
<span style="color:blue">And now we have the rules :
</span> <br>
<img width="500" alt="Screenshot" src="https://github.com/Will-Zidane/SecurityLab/blob/main/Firewall/Screenshot%202024-07-15%20at%2020.22.08.png?raw=true"><br>
<span style="color:blue">Now the inner1 cannot curl or telnet badsite :
</span> <br>
<img width="500" alt="Screenshot" src="https://github.com/Will-Zidane/SecurityLab/blob/main/Firewall/Screenshot%202024-07-15%20at%2020.22.20.png?raw=true"><br>
<img width="500" alt="Screenshot" src="https://github.com/Will-Zidane/SecurityLab/blob/main/Firewall/Screenshot%202024-07-15%20at%2020.22.48.png?raw=true"><br>
<span style="color:blue">Link Discord :<a>https://github.com/Will-Zidane/SecurityLab/edit/main/19110113.md</a>
</span> <br>
